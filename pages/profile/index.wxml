<view class="container">
  <view class="card">
    <view class="user-section">
      <view class="avatar-wrapper" bindtap="onChooseAvatar">
        <image
          class="avatar"
          src="{{user && user.avatarBase64 ? user.avatarBase64 : 'https://ui-avatars.com/api/?name=U&background=667eea&color=fff&size=256&rounded=true'}}"
          mode="aspectFill"
        />
        <view class="avatar-hint" wx:if="{{user}}">点击更换</view>
      </view>
      <view class="user-info">
        <view class="name">{{user && user.nickName ? user.nickName : '未登录'}}</view>
        <view class="muted sub">{{user ? '已授权' : '登录后可显示头像昵称'}}</view>
      </view>
    </view>

    <view class="row ops" wx:if="{{user}}">
      <button class="btn btn-ghost" size="mini" bindtap="onUpdateNickName">修改昵称</button>
      <button class="btn btn-ghost" size="mini" bindtap="onDeleteAvatar" wx:if="{{user.avatarBase64}}">删除头像</button>
    </view>

    <view class="row ops">
      <button class="btn btn-primary" size="mini" bindtap="onLogin">{{user ? '重新授权' : '微信登录'}}</button>
      <button class="btn btn-ghost" size="mini" bindtap="onLogout" wx:if="{{user}}">退出登录</button>
      <button class="btn btn-ghost" size="mini" open-type="share">分享小程序</button>
    </view>
  </view>

  <view class="card mt">
    <view class="h1">数据</view>
    <view class="row space-between kv">
      <view class="muted">总任务</view>
      <view class="v">{{stats.total}}</view>
    </view>
    <view class="row space-between kv">
      <view class="muted">进行中</view>
      <view class="v">{{stats.active}}</view>
    </view>
    <view class="row space-between kv">
      <view class="muted">已完成</view>
      <view class="v">{{stats.done}}</view>
    </view>

    <button class="btn btn-ghost" bindtap="onGoSync">数据同步（导入/导出）</button>
  </view>

  <view class="card mt">
    <view class="h1">快捷</view>
    <button class="btn btn-primary" bindtap="onAdd">新建任务</button>
    <button class="btn btn-ghost" bindtap="onClearAll">清空所有任务</button>
  </view>

  <view style="height: 140rpx;"></view>
</view>
